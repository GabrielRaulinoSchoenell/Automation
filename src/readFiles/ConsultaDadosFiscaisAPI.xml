<?xml version="1.0" encoding="UTF-8"?>
<api context="/pessoa" name="ConsultaDadosFiscaisAPI" xmlns="http://ws.apache.org/ns/synapse">
    <resource methods="GET" uri-template="/v1/juridica/{cnpj}">
        <inSequence>
            <log level="custom">
                <property expression="fn:concat('Requisicao recebida! - ','/pessoa/v1/juridica/',$ctx:uri.var.cnpj)" name="--> "/>
            </log>
            <sequence key="VariaveisAmbienteSequence"/>
            <sequence key="SVCConsultaPessoaDepsSequence"/>
            <log level="custom" separator="&#x9;&#xa;">
                <property expression="fn:concat('Requisicao finalizada! - ','/pessoa/v1/juridica/',$ctx:uri.var.cnpj)" name="--> "/>
            </log>
            <respond/>
        </inSequence>
        <outSequence/>
        <faultSequence>
            <respond/>
        </faultSequence>
    </resource>
    <resource methods="POST" uri-template="/v1/juridica/{cnpj}">
        <inSequence>
            <log level="custom">
                <property expression="fn:concat('Requisicao recebida! - ','/pessoa/v1/juridica/',$ctx:uri.var.cnpj)" name="--> "/>
            </log>
            <sequence key="VariaveisAmbienteSequence"/>
            <sequence key="SVCConsultaPessoaDepsSequence"/>
            <log level="custom" separator="&#x9;&#xa;">
                <property expression="fn:concat('Requisicao finalizada! - ','/pessoa/v1/juridica/',$ctx:uri.var.cnpj)" name="--> "/>
            </log>
            <respond/>
        </inSequence>
        <outSequence/>
        <faultSequence>
            <respond/>
        </faultSequence>
    </resource>
    <resource methods="GET" uri-template="/v1/juridica/{cnpj}/{grupoCobranca}">
        <inSequence>
            <log level="custom">
                <property expression="fn:concat('Requisicao recebida! - ','/pessoa/v1/juridica/',$ctx:uri.var.cnpj, '/',$ctx:uri.var.grupoCobranca)" name="-->"/>
            </log>
            <sequence key="VariaveisAmbienteSequence"/>
            <log level="custom" separator="&#x9;&#xa;">
                <property name="--> " value="Criando limite"/>
            </log>
            <sequence key="SVCRequisicaoLimiteDepsSequence"/>
            <filter regex="200" source="$axis2:HTTP_SC">
                <then>
                    <log level="custom" separator="&#x9;&#xa;">
                        <property name="--> " value="Limite gerado"/>
                        <property name="--> " value="Consultando novamente o cliente"/>
                    </log>
                    <sequence key="SVCConsultaPessoaDepsSequence"/>
                </then>
                <else/>
            </filter>
            <log level="custom" separator="&#x9;&#xa;">
                <property expression="fn:concat('Requisicao finalizada! - ','/pessoa/v1/juridica/',$ctx:uri.var.cnpj, '/',$ctx:uri.var.grupoCobranca)" name="-->"/>
            </log>
            <respond/>
        </inSequence>
        <outSequence/>
        <faultSequence>
            <respond/>
        </faultSequence>
    </resource>
</api>
