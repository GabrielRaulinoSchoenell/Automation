<?xml version="1.0" encoding="UTF-8"?>
<api context="/centro-custo/v2" name="CentroCustoAPI-v2" xmlns="http://ws.apache.org/ns/synapse">
    <resource methods="GET" url-mapping="/centro-custo">
        <inSequence>
            <filter regex="true" source="boolean($ctx:query.param.codigo)">
                <then>
                    <log level="custom">
                        <property name="--> " value="Requisitando recebida! - /centro-custo/v1/centro-custo?codigo={value}"/>
                    </log>
                    <sequence key="ListarCentroDeCustoSequence"/>
                    <xslt key="conf:transform/TransformCentroCustoCodigo.xslt">
                        <property expression="$ctx:query.param.codigo" name="PARAM_CODIGO"/>
                    </xslt>
                    <propertyGroup>
                        <property expression="$trp:Accept" name="messageType" scope="axis2" type="STRING"/>
                        <property expression="$trp:Accept" name="Content-Type" scope="axis2" type="STRING"/>
                    </propertyGroup>
                    <log level="full">
                        <property name="--> " value="Requisitando finalizada!"/>
                    </log>
                </then>
                <else>
                    <log level="custom">
                        <property name="--> " value="Requisitando recebida! - /centro-custo/v1/centro-custo"/>
                    </log>
                    <sequence key="ListarCentroDeCustoSequence"/>
                    <propertyGroup>
                        <property expression="$trp:Accept" name="messageType" scope="axis2" type="STRING"/>
                        <property expression="$trp:Accept" name="Content-Type" scope="axis2" type="STRING"/>
                    </propertyGroup>
                    <log level="custom">
                        <property name="--> " value="Requisitando finalizada!"/>
                    </log>
                </else>
            </filter>
            <filter regex="true" source="boolean(boolean($ctx:query.param.estabelecimento) and boolean($ctx:query.param.estabelecimento))">
                <then>
                    <log level="custom">
                        <property name="--> " value="Requisitando recebida! - /centro-custo/v1/centro-custo?codigo={value}ANDestabelecimento={value}"/>
                    </log>
                    <sequence key="ListarCentroDeCustoSequence"/>
                    <xslt key="conf:transform/TransformCentroCusto.xslt">
                        <property expression="$ctx:query.param.estabelecimento" name="PARAM_ESTAB"/>
                        <property expression="$ctx:query.param.codigo" name="PARAM_CODIGO"/>
                    </xslt>
                    <propertyGroup>
                        <property expression="$trp:Accept" name="messageType" scope="axis2" type="STRING"/>
                        <property expression="$trp:Accept" name="Content-Type" scope="axis2" type="STRING"/>
                    </propertyGroup>
                    <log level="full">
                        <property name="--> " value="Requisitando finalizada!"/>
                    </log>
                </then>
                <else/>
            </filter>
            <filter regex="true" source="boolean($ctx:query.param.descricao)">
                <then>
                    <log level="custom">
                        <property name="--> " value="Requisitando recebida! - /centro-custo/v1/centro-custo?descricao={value}"/>
                    </log>
                    <sequence key="ListarCentroDeCustoSequence"/>
                    <xslt key="conf:transform/TransformCentroCustoDescricao.xslt">
                        <property expression="$ctx:query.param.descricao" name="PARAM_DESCRICAO"/>
                    </xslt>
                    <propertyGroup>
                        <property expression="$trp:Accept" name="messageType" scope="axis2" type="STRING"/>
                        <property expression="$trp:Accept" name="Content-Type" scope="axis2" type="STRING"/>
                    </propertyGroup>
                    <log level="full">
                        <property name="--> " value="Requisitando finalizada!"/>
                    </log>
                </then>
                <else/>
            </filter>
            <respond/>
        </inSequence>
        <outSequence/>
        <faultSequence/>
    </resource>
</api>
